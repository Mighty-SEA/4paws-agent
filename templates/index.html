<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4Paws Agent Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>üêæ 4Paws Agent Dashboard</h1>
                <span class="version">v1.0</span>
            </div>
            <div class="header-right">
                <button class="theme-toggle" onclick="toggleTheme()" title="Toggle Dark/Light Mode">
                    <span class="theme-icon">üåô</span>
                </button>
                <button class="refresh-btn" onclick="refreshStatus()" title="Refresh Status">
                    üîÑ
                </button>
            </div>
        </header>

        <!-- System Info -->
        <div class="system-info">
            <div class="info-card">
                <div class="info-label">CPU</div>
                <div class="info-value" id="cpu-usage">--</div>
            </div>
            <div class="info-card">
                <div class="info-label">Memory</div>
                <div class="info-value" id="memory-usage">--</div>
            </div>
            <div class="info-card">
                <div class="info-label">Disk</div>
                <div class="info-value" id="disk-usage">--</div>
            </div>
        </div>

        <!-- Application URLs -->
        <div class="app-urls">
            <h2>üåê Application URLs</h2>
            <div class="url-grid">
                <div class="url-card">
                    <div class="url-icon">üé®</div>
                    <div class="url-content">
                        <div class="url-label">Frontend</div>
                        <a href="http://localhost:3100" target="_blank" class="url-link">
                            http://localhost:3100
                        </a>
                        <div class="url-path" id="frontend-path">üìÅ Loading...</div>
                        <div class="url-status" id="frontend-url-status">‚óè</div>
                    </div>
                </div>
                <div class="url-card">
                    <div class="url-icon">üîß</div>
                    <div class="url-content">
                        <div class="url-label">Backend API</div>
                        <a href="http://localhost:3200" target="_blank" class="url-link">
                            http://localhost:3200
                        </a>
                        <div class="url-path" id="backend-path">üìÅ Loading...</div>
                        <div class="url-status" id="backend-url-status">‚óè</div>
                    </div>
                </div>
                <div class="url-card">
                    <div class="url-icon">ü¶ã</div>
                    <div class="url-content">
                        <div class="url-label">Database</div>
                        <div class="url-link">
                            localhost:3307
                        </div>
                        <div class="url-path" id="mariadb-path">üìÅ Loading...</div>
                        <div class="url-status" id="mariadb-url-status">‚óè</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <h2>‚ö° Quick Actions</h2>
            <div class="action-grid">
                <button class="action-btn btn-success" onclick="startAll()">
                    <span class="action-icon">‚ñ∂Ô∏è</span>
                    <span class="action-text">Start All</span>
                </button>
                <button class="action-btn btn-danger" onclick="stopAll()">
                    <span class="action-icon">‚èπÔ∏è</span>
                    <span class="action-text">Stop All</span>
                </button>
                <button class="action-btn btn-info" onclick="checkUpdates()">
                    <span class="action-icon">üîÑ</span>
                    <span class="action-text">Check Updates</span>
                </button>
                <button class="action-btn btn-warning" onclick="showSetupModal()">
                    <span class="action-icon">‚öôÔ∏è</span>
                    <span class="action-text">Setup Apps</span>
                </button>
                <button class="action-btn btn-primary" onclick="showInstallModal()">
                    <span class="action-icon">üì¶</span>
                    <span class="action-text">Install Apps</span>
                </button>
                <button class="action-btn btn-secondary" onclick="showSeedModal()">
                    <span class="action-icon">üå±</span>
                    <span class="action-text">Seed Database</span>
                </button>
            </div>
        </div>

        <!-- Services Status -->
        <div class="services-section">
            <h2>üñ•Ô∏è Services Status</h2>
            <div class="services-grid">
                <!-- MariaDB -->
                <div class="service-card" id="mariadb-card">
                    <div class="service-header">
                        <h3>ü¶ã MariaDB</h3>
                        <span class="status-badge" id="mariadb-status">Stopped</span>
                    </div>
                    <div class="service-info">
                        <div class="info-row">
                            <span>Port:</span>
                            <span id="mariadb-port">3307</span>
                        </div>
                        <div class="info-row">
                            <span>PID:</span>
                            <span id="mariadb-pid">--</span>
                        </div>
                        <div class="info-row">
                            <span>CPU:</span>
                            <span id="mariadb-cpu">--</span>
                        </div>
                        <div class="info-row">
                            <span>Memory:</span>
                            <span id="mariadb-memory">--</span>
                        </div>
                    </div>
                    <div class="service-actions">
                        <button class="btn btn-sm btn-success" onclick="startService('mariadb')">Start</button>
                        <button class="btn btn-sm btn-danger" onclick="stopService('mariadb')">Stop</button>
                    </div>
                </div>

                <!-- Backend -->
                <div class="service-card" id="backend-card">
                    <div class="service-header">
                        <h3>üîß Backend API</h3>
                        <span class="status-badge" id="backend-status">Stopped</span>
                    </div>
                    <div class="service-info">
                        <div class="info-row">
                            <span>Port:</span>
                            <span id="backend-port">3200</span>
                        </div>
                        <div class="info-row">
                            <span>PID:</span>
                            <span id="backend-pid">--</span>
                        </div>
                        <div class="info-row">
                            <span>CPU:</span>
                            <span id="backend-cpu">--</span>
                        </div>
                        <div class="info-row">
                            <span>Memory:</span>
                            <span id="backend-memory">--</span>
                        </div>
                        <div class="info-row">
                            <span>Version:</span>
                            <span id="backend-version">--</span>
                        </div>
                    </div>
                    <div class="service-actions">
                        <button class="btn btn-sm btn-success" onclick="startService('backend')">Start</button>
                        <button class="btn btn-sm btn-danger" onclick="stopService('backend')">Stop</button>
                        <button class="btn btn-sm btn-info" onclick="openBackend()">Open</button>
                    </div>
                </div>

                <!-- Frontend -->
                <div class="service-card" id="frontend-card">
                    <div class="service-header">
                        <h3>üé® Frontend</h3>
                        <span class="status-badge" id="frontend-status">Stopped</span>
                    </div>
                    <div class="service-info">
                        <div class="info-row">
                            <span>Port:</span>
                            <span id="frontend-port">3100</span>
                        </div>
                        <div class="info-row">
                            <span>PID:</span>
                            <span id="frontend-pid">--</span>
                        </div>
                        <div class="info-row">
                            <span>CPU:</span>
                            <span id="frontend-cpu">--</span>
                        </div>
                        <div class="info-row">
                            <span>Memory:</span>
                            <span id="frontend-memory">--</span>
                        </div>
                        <div class="info-row">
                            <span>Version:</span>
                            <span id="frontend-version">--</span>
                        </div>
                    </div>
                    <div class="service-actions">
                        <button class="btn btn-sm btn-success" onclick="startService('frontend')">Start</button>
                        <button class="btn btn-sm btn-danger" onclick="stopService('frontend')">Stop</button>
                        <button class="btn btn-sm btn-info" onclick="openFrontend()">Open</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Updates Section -->
        <div class="updates-section" id="updates-section" style="display: none;">
            <h2>üì• Available Updates</h2>
            <div id="updates-content"></div>
        </div>

        <!-- Logs Section -->
        <div class="logs-section">
            <h2>üìù Logs</h2>
            <div class="logs-tabs">
                <button class="log-tab active" onclick="showLogs('agent')">Agent</button>
                <button class="log-tab" onclick="showLogs('backend')">Backend</button>
                <button class="log-tab" onclick="showLogs('frontend')">Frontend</button>
                <button class="log-tab" onclick="showLogs('mariadb')">MariaDB</button>
            </div>
            <div class="logs-content">
                <pre id="logs-output"></pre>
            </div>
        </div>
    </div>

    <!-- Install Modal -->
    <div id="installModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('installModal')">&times;</span>
            <h2>üì¶ Install Applications</h2>
            <p>Download and install applications from GitHub releases</p>
            <div class="modal-buttons">
                <button class="btn btn-primary" onclick="installApp('all')">Install Both</button>
                <button class="btn btn-primary" onclick="installApp('frontend')">Frontend Only</button>
                <button class="btn btn-primary" onclick="installApp('backend')">Backend Only</button>
            </div>
        </div>
    </div>

    <!-- Setup Modal -->
    <div id="setupModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('setupModal')">&times;</span>
            <h2>‚öôÔ∏è Setup Applications</h2>
            <p>Install dependencies, run migrations, and prepare applications</p>
            <div class="modal-buttons">
                <button class="btn btn-warning" onclick="setupApp('all')">Setup Both</button>
                <button class="btn btn-warning" onclick="setupApp('frontend')">Frontend Only</button>
                <button class="btn btn-warning" onclick="setupApp('backend')">Backend Only</button>
            </div>
        </div>
    </div>

    <!-- Seed Modal -->
    <div id="seedModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('seedModal')">&times;</span>
            <h2>üå± Seed Database</h2>
            <p>Populate database with sample data</p>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="seedDatabase('all')">Seed All</button>
                <button class="btn btn-secondary" onclick="seedDatabase('users')">Users</button>
                <button class="btn btn-secondary" onclick="seedDatabase('services')">Services</button>
                <button class="btn btn-secondary" onclick="seedDatabase('store-settings')">Store Settings</button>
                <button class="btn btn-secondary" onclick="seedDatabase('pet-species')">Pet Species</button>
                <button class="btn btn-secondary" onclick="seedDatabase('owners-pets')">Owners & Pets</button>
                <button class="btn btn-secondary" onclick="seedDatabase('products-mix')">Products</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p id="loadingText">Processing...</p>
        </div>
    </div>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
